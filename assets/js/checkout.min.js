jQuery(document).ready(function(o){var e=pickersTime.startTime,t=pickersTime.endTime,i=pickersTime.interval,n=[],r=moment(e,"HH:mm"),a=moment(t,"HH:mm"),s=pickersDate.disabledDates.map(function(e){return moment(e,"DD.MM.YYYY").toDate()}),e=Array.from(document.body.classList).includes("lang-he"),t=["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"],c=new Date,l=new Date;l.setMonth(c.getMonth()+4),o(document).on("change",".step-content.active  input.required, .step-content.active  select.required",function(){var e=document.querySelector(".step-content.active .btn-continue"),t=!0;o(".step-content.active  input.required, .step-content.active  select.required").each(function(){""===o(this).val()&&(t=!1)}),t&&e.classList.add("active")});var u,d,m,p=document.querySelectorAll(".btn-continue");function y(e){var t,i,n,r;3!=e&&(t=o(".step-"+e),i=!0,n=(t=t).find('input[name="choose_delivery"]:checked').val(),t[0].classList.contains("step-1")?"pickup"===n?t.find('input[name^="pickup_"], select[name^="pickup_"]').each(function(e,t){o(this).val()?o(this).removeClass("input-error"):(i=!1,o(this).addClass("input-error"))}):t.find('input[name^="shipping_"], select[name^="shipping_"]').each(function(e,t){o(this).val()?o(this).removeClass("input-error"):(i=!1,o(this).addClass("input-error"))}):t[0].querySelectorAll(".validate-required").forEach(function(e,t){e.querySelectorAll("input, select").forEach(function(e,t){jQuery("#ship-to-different-address-checkbox").is(":checked")?document.querySelectorAll(".woocommerce-shipping-fields__field-wrapper .validate-required").forEach(function(e,t){e.querySelectorAll("input, select").forEach(function(e,t){e.value?e.classList.remove("input-error"):(i=!1,e.classList.add("input-error"))})}):document.querySelectorAll(".woocommerce-billing-fields .validate-required").forEach(function(e,t){e.querySelectorAll("input, select").forEach(function(e,t){e.value?e.classList.remove("input-error"):(i=!1,e.classList.add("input-error"))})})})}),i?(r=e+1,o(".step").removeClass("current").filter(function(){return o(this).data("step")===r}).addClass("active current"),o(".step-content").removeClass("active"),o(".step-"+r).addClass("active")):((n=document.createElement("div")).classList.add("form-error-message"),document.querySelector("body").classList.contains("lang-he")?n.innerHTML="אנא מלא את כל השדות הדרושים.":n.innerHTML="Please fill out all required fields.",document.querySelector("body").appendChild(n),setTimeout(function(){document.querySelector(".form-error-message").remove()},3500)))}for(let e=0;e<p.length;e++)p[e].addEventListener("click",()=>{y(parseInt(o(".step.current").data("step"),10))});let f=document.querySelector(".delivery"),v=document.querySelector(".collect-in-store"),g=document.querySelector(".delivery-form"),h=document.querySelector(".collect-in-store-form"),D=(f&&f.addEventListener("click",()=>{f.classList.contains("active")||(v.classList.remove("active"),f.classList.add("active")),g.classList.contains("active")||(h.classList.remove("active"),g.classList.add("active"))}),v&&v.addEventListener("click",()=>{v.classList.contains("active")||(f.classList.remove("active"),v.classList.add("active")),h.classList.contains("active")||(g.classList.remove("active"),h.classList.add("active"))}),document.querySelector(".different-name-invoice")),L=document.querySelector(".billing-info-form"),S=(D&&D.addEventListener("click",()=>{document.querySelector(".step-content.active .btn-continue");D.classList.contains("active")?D.classList.remove("active"):D.classList.add("active"),L.classList.contains("active")?L.classList.remove("active"):L.classList.add("active")}),document.querySelectorAll(".order-summary-btn-mobile")),k=document.querySelectorAll(".order-summary-mobile");if(S)for(let e=0;e<S.length;e++)S[e].addEventListener("click",()=>{k[e].querySelector(".products-list").classList.toggle("active"),k[e].querySelector(".edit-order").classList.toggle("active"),S[e].classList.toggle("active")});for(document.addEventListener("click",function(e){e.target.classList.contains("btn-see-whole-order")&&(e.preventDefault(),document.querySelector(".list").classList.remove("load_items"),e.target.remove())});r.isBefore(a);){var j=moment(r).add(i,"minutes");j.isAfter(a)&&(j=a),n.push(r.format("HH:mm")+" - "+j.format("HH:mm")),r.add(i,"minutes")}for(u in n)n.hasOwnProperty(u)&&((d=jQuery("<button />").text(n[u])).on("click",function(){jQuery("#shipping_time").val(jQuery(this).text()),jQuery("#pickup_time").val(jQuery(this).text()),jQuery("#timeslots").dialog("close")}),jQuery("#timeslots").append(d));jQuery("#timeslots").dialog({autoOpen:!1,modal:!0,buttons:{},open:function(e,t){jQuery(".ui-widget-overlay").on("click",function(){jQuery("#timeslots").dialog("close")})}}),jQuery("#shipping_time").on("click",function(){jQuery("#timeslots").dialog("open")}),jQuery("#pickup_time").on("click",function(){jQuery("#timeslots").dialog("open")}),m=e?new Pikaday({field:document.getElementById("datepicker"),format:"DD.MM.YYYY",minDate:new Date,maxDate:l,i18n:{previousMonth:"החודש הקודם",nextMonth:"החודש הבא",months:t,weekdays:["ראשון","שני","שלישי","רביעי","חמישי","שישי","שבת"],weekdaysShort:["א","ב","ג","ד","ה","ו","ש"]},disableDayOfWeek:[6],disableDayFn:function(t){var e=new Date;return e.setHours(0,0,0,0),t.getTime()===e.getTime()||6===t.getDay()||s.some(function(e){return moment(t).isSame(e,"day")})},onSelect:function(){jQuery("#shipping_date").val(this.toString()),jQuery("#pickup_date").val(this.toString()),jQuery("#dateslot").dialog("close")}}):new Pikaday({field:document.getElementById("datepicker"),format:"DD.MM.YYYY",minDate:new Date,disableDayOfWeek:[6],maxDate:l,disableDayFn:function(t){var e=new Date;return e.setHours(0,0,0,0),t.getTime()===e.getTime()||6===t.getDay()||s.some(function(e){return moment(t).isSame(e,"day")})},onSelect:function(){jQuery("#shipping_date").val(this.toString()),jQuery("#pickup_date").val(this.toString()),jQuery("#dateslot").dialog("close")}}),jQuery("#dateslot").dialog({autoOpen:!1,modal:!0,dialogClass:"dateslot-dialog",open:function(){m.show(),jQuery(".ui-widget-overlay").on("click",function(){jQuery("#dateslot").dialog("close")})},close:function(){m.hide()}}),jQuery("#shipping_date").on("click",function(){jQuery("#dateslot").dialog("open")}),jQuery("#pickup_date").on("click",function(){jQuery("#dateslot").dialog("open")});var Q,w,q,_=new Pikaday({field:document.getElementById("deliveryDate_pdf_export"),format:"DD.MM.YYYY",minDate:new Date,disableDayOfWeek:[6],autoClose:!0,disableDayFn:function(t){var e=new Date;return e.setHours(0,0,0,0),t.getTime()===e.getTime()||6===t.getDay()||s.some(function(e){return moment(t).isSame(e,"day")})},onSelect:function(){jQuery("#deliveryDate_pdf_export").val(this.toString()),jQuery("#deliveryDate_pdf_export").trigger("input"),_.hide(0)}});function b(){q.every(function(e){return""!==e.value})?(w.disabled=!1,w.classList.add("active")):(w.disabled=!0,w.classList.remove("active"))}_=e?new Pikaday({field:document.getElementById("deliveryDate_pdf_export"),format:"DD.MM.YYYY",minDate:new Date,disableDayOfWeek:[6],maxDate:l,autoClose:!0,i18n:{previousMonth:"החודש הקודם",nextMonth:"החודש הבא",months:t,weekdays:["ראשון","שני","שלישי","רביעי","חמישי","שישי","שבת"],weekdaysShort:["א","ב","ג","ד","ה","ו","ש"]},disableDayFn:function(t){var e=new Date;return e.setHours(0,0,0,0),t.getTime()===e.getTime()||6===t.getDay()||s.some(function(e){return moment(t).isSame(e,"day")})},onSelect:function(){jQuery("#deliveryDate_pdf_export").val(this.toString()),jQuery("#deliveryDate_pdf_export").trigger("input"),_.hide(0)}}):new Pikaday({field:document.getElementById("deliveryDate_pdf_export"),format:"DD.MM.YYYY",minDate:new Date,disableDayOfWeek:[6],maxDate:l,autoClose:!0,disableDayFn:function(t){var e=new Date;return e.setHours(0,0,0,0),t.getTime()===e.getTime()||6===t.getDay()||s.some(function(e){return moment(t).isSame(e,"day")})},onSelect:function(){jQuery("#deliveryDate_pdf_export").val(this.toString()),jQuery("#deliveryDate_pdf_export").trigger("input"),_.hide(0)}}),jQuery(".export-btn").on("click",function(e){e.preventDefault(),jQuery("#export-popup").show()}),jQuery(".get_pdf").on("click",function(e){var t=new URL(jQuery(this).data("pdf"));jQuery("#export-popup :input").each(function(){jQuery(this).val()&&t.searchParams.append(jQuery(this).attr("name"),jQuery(this).val())}),jQuery(this).attr("data-pdf",t.toString()),window.location.href=t.toString()}),0<jQuery("body.woocommerce-cart").length&&(Q=document.getElementById("export-popup"),w=Q.querySelector("button"),q=Array.from(Q.querySelectorAll("input[required]")),Array.from(Q.querySelectorAll("input")).forEach(function(e){e.addEventListener("input",b)}),window.addEventListener("click",function(e){e.target==Q&&(Q.style.display="none")}),window.addEventListener("keydown",function(e){"Escape"===e.key&&(Q.style.display="none")})),document.addEventListener("click",function(e){e.target.closest(".step")&&(document.querySelectorAll(".step").forEach(function(e,t){e.classList.remove("active"),e.classList.remove("current")}),e.target.closest(".step").classList.add("active"),e.target.closest(".step").classList.add("current"),e=e.target.closest(".step").dataset.step,document.querySelectorAll(".step-content").forEach(function(e,t){e.classList.remove("active")}),document.querySelector(".step-"+e).classList.add("active"))}),jQuery(document).ready(function(e){e("#delivery_city").select2({minimumInputLength:3,placeholder:"בחר עיר",allowClear:!0,dir:"rtl",language:{inputTooShort:function(){return"נא להזין 3 תווים או יותר"},noResults:function(){return"לא נמצאו תוצאות"}}})})});